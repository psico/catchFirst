<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Catch First</title>

    <style>
        #screen {
            border: 10px solid #ccc;
            image-rendering: pixelated;
            /*image-rendering: crisp-edges;*/
            /*image-rendering: -moz-crisp-edges;*/
            width: 400px;
            height: 400px;
        }
    </style>
    <script src="keyboard-listener.js"></script>
</head>
<body>
<canvas id="screen" width="10" height="10"></canvas>

<script type="module">
    import createGame from "./game.js";
    import createKeyboardListener from "./keyboard-listener.js";

    const screen = document.getElementById("screen");
    const context = screen.getContext('2d');

    const game = createGame();
    const keyboardListener = createKeyboardListener();
    keyboardListener.subscribe(game.movePlayer);

    game.addPlayer({playerId: 'player1', playerX: 0, playerY: 0});
    game.addFruit({fruitId: 'fruit1', fruitX: 3, fruitY: 3});

    renderScreen();

    function renderScreen() {
        // context.fillStyle = 'white';
        context.clearRect(0, 0, 10, 10);

        for (const playerId in game.state.players) {
            const player = game.state.players[playerId];
            context.fillStyle = 'black';
            context.fillRect(player.x, player.y, 1, 1)
        }

        for (const fruitId in game.state.fruits) {
            const fruit = game.state.fruits[fruitId];
            context.fillStyle = 'green';
            context.fillRect(fruit.x, fruit.y, 1, 1)
        }

        requestAnimationFrame(renderScreen);
    }
</script>
</body>
</html>
